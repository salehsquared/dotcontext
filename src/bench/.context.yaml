version: 1
last_updated: 2026-02-13T17:38:42.176Z
fingerprint: 4d62be17
scope: src/bench
summary: >
  The `src/bench` directory provides a framework for benchmarking the performance of AI models using structured tasks.
  It includes the setup for cloning repositories, generating tasks based on code structure, and scoring the results of
  model responses.
maintenance: |-
  If you modify files in this directory, update this .context.yaml to reflect
  your changes. Update the summary, and any decisions or constraints that changed.
  Do NOT update the fingerprint manually â€” run `context rehash` or it will be
  updated automatically on the next `context status` check.
  If you only read files in this directory, do not modify this file.
  Do not include secrets, API keys, passwords, or PII in this file.
decisions:
  - what: Tasks are categorized into specific types (e.g., comprehension, dependency, change impact).
    why: This allows for targeted evaluation and deeper insights into AI model performance across various aspects of the
      codebase.
    tradeoff: While this increases complexity in task generation, it enables more nuanced evaluations.
constraints:
  - All tasks must adhere to the defined scoring methods and follow the expected output format.
  - Task generation is based on existing file structure and commit history; tasks cannot be generated for directories
    with insufficient files or dependencies.
dependencies:
  internal:
    - ../core/scanner.js
    - ../core/schema.js
    - ../generator/dependencies.js
    - ../generator/static.js
    - ../providers/index.js
    - ./git.js
    - ./ground-truth.js
    - ./prompts.js
    - ./scorer.js
    - ./token-estimator.js
    - ./types.js
exports:
  - "function isGitRepo(dirPath: string): boolean"
  - "function getFixCommits(repoPath: string, count: number): Commit[]"
  - "function getFeatureCommits(repoPath: string, count: number): Commit[]"
  - "async function cloneRepo( url: string, destDir: string, depth = 100, ): Promise<string>"
  - "async function buildDepSets( scanResult: ScanResult, ): Promise<"
  - "async function buildReverseDeps( scanResult: ScanResult, ): Promise<Map<string, string[]>>"
  - "async function buildDirFacts( scanResult: ScanResult, ): Promise<Map<string, DirFacts>>"
  - 'function buildFileTree(scanResult: ScanResult, indent = ""): string'
  - interface ScopeWindow
  - "function computeScopeWindow( sourceScope: string, scanResult: ScanResult, ): ScopeWindow"
  - "function buildScopedFileTree( sourceScope: string, scanResult: ScanResult, ):"
  - BENCH_SYSTEM_PROMPT
  - "function buildReadmeSnippet(readme: string | null, maxChars = DEFAULT_README_SNIPPET_CHARS): string | null"
  - "function buildBaselinePrompt( fileTree: string, readme: string | null, question: string, sourceScope?: string, ):
    string"
  - "function buildContextPrompt( fileTree: string, contextFiles: Map<string, ContextFile>, question: string,
    sourceScope?: string, ): string"
  - "function buildJudgePrompt( question: string, response: string, referenceFacts: string[], ): string"
  - interface DefaultRepo
  - "DEFAULT_REPOS: DefaultRepo[]"
  - "async function cloneAndInit( repo: DefaultRepo, initFn: (rootPath: string) => Promise<void>, ): Promise<string>"
  - "async function cleanupRepos(tempDirs: string[]): Promise<void>"
  - interface RunBenchOptions
  - "async function runBench(options: RunBenchOptions): Promise<TaskResult[]>"
  - JUDGE_SYSTEM_PROMPT
  - "function detectAbstention(response: string): boolean"
  - "function scoreListCoverage(response: string, expected: string[]): number"
derived_fields:
  - version
  - last_updated
  - fingerprint
  - scope
  - dependencies.internal
  - exports
