version: 1
last_updated: 2026-02-13T06:14:48.428Z
fingerprint: 80c2bdd0
scope: src/bench
summary: >
  The `src/bench` directory contains functionalities for benchmarking code understanding using a set of tasks, scoring
  methods, and various prompts. It integrates git operations for commit analysis and computes dependency structures,
  guiding task generation and evaluation for AI-assisted code comprehension.
maintenance: |-
  If you modify files in this directory, update this .context.yaml to reflect
  your changes. Update the summary, and any decisions or constraints that changed.
  Do NOT update the fingerprint manually â€” run `context rehash` or it will be
  updated automatically on the next `context status` check.
  If you only read files in this directory, do not modify this file.
  Do not include secrets, API keys, passwords, or PII in this file.
decisions:
  - what: The directory utilizes a specific scoring system for task evaluation.
    why: This allows for consistent and structured results across varying task types.
    tradeoff: The complexity of managing multiple scoring methods may introduce overhead in task definition.
constraints:
  - Dependencies must be synchronized with the task definitions and given the correct criteria for evaluation.
  - Git operations must handle failures gracefully to avoid breaking the benchmarking process.
dependencies:
  internal:
    - ../core/scanner.js
    - ../core/schema.js
    - ../generator/dependencies.js
    - ../generator/static.js
    - ../providers/index.js
    - ./git.js
    - ./ground-truth.js
    - ./prompts.js
    - ./scorer.js
    - ./types.js
exports:
  - "function isGitRepo(dirPath: string): boolean"
  - "function getFixCommits(repoPath: string, count: number): Commit[]"
  - "function getFeatureCommits(repoPath: string, count: number): Commit[]"
  - "async function cloneRepo( url: string, destDir: string, depth = 100, ): Promise<string>"
  - "async function buildDepSets( scanResult: ScanResult, ): Promise<"
  - "async function buildReverseDeps( scanResult: ScanResult, ): Promise<Map<string, string[]>>"
  - "async function buildDirFacts( scanResult: ScanResult, ): Promise<Map<string, DirFacts>>"
  - 'function buildFileTree(scanResult: ScanResult, indent = ""): string'
  - "async function computeScopeTokens( sourceScope: string, scanResult: ScanResult, contextFileSizes: Map<string,
    number>, ): Promise<"
  - BENCH_SYSTEM_PROMPT
  - "function buildBaselinePrompt( fileTree: string, readme: string | null, question: string, ): string"
  - "function buildContextPrompt( fileTree: string, contextFiles: Map<string, ContextFile>, question: string, ): string"
  - "function buildJudgePrompt( question: string, response: string, referenceFacts: string[], ): string"
  - interface DefaultRepo
  - "DEFAULT_REPOS: DefaultRepo[]"
  - "async function cloneAndInit( repo: DefaultRepo, initFn: (rootPath: string) => Promise<void>, ): Promise<string>"
  - "async function cleanupRepos(tempDirs: string[]): Promise<void>"
  - interface RunBenchOptions
  - "async function runBench(options: RunBenchOptions): Promise<TaskResult[]>"
  - "function detectAbstention(response: string): boolean"
  - "function scoreListCoverage(response: string, expected: string[]): number"
  - "function scoreTopkRecall(response: string, expected: string[]): number"
  - "function scoreTargetHit(response: string, expected: string[]): number"
  - "function scoreMrr(response: string, expected: string[]): number"
  - "function scoreFileSetF1(response: string, expected: string[]): number"
derived_fields:
  - version
  - last_updated
  - fingerprint
  - scope
  - dependencies.internal
  - exports
